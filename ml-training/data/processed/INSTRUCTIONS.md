# 🔄 Processed Dataset Instructions

## 📁 Directory Structure

This directory contains preprocessed images ready for model training:

```
processed/
├── train/                     # Training set (70%)
│   ├── healthy/
│   ├── bacterial_wilt/
│   ├── rhizome_rot/
│   ├── leaf_spot/
│   ├── soft_rot/
│   ├── yellow_disease/
│   └── root_knot_nematode/
├── validation/                # Validation set (15%)
│   ├── healthy/
│   ├── bacterial_wilt/
│   ├── rhizome_rot/
│   ├── leaf_spot/
│   ├── soft_rot/
│   ├── yellow_disease/
│   └── root_knot_nematode/
└── test/                      # Test set (15%)
    ├── healthy/
    ├── bacterial_wilt/
    ├── rhizome_rot/
    ├── leaf_spot/
    ├── soft_rot/
    ├── yellow_disease/
    └── root_knot_nematode/
```

## ⚙️ Processing Pipeline

Images in this directory have been processed through:

### **Preprocessing Steps**
1. **Quality filtering**: Low-quality images removed
2. **Resizing**: Standardized to 224x224 pixels
3. **Normalization**: Pixel values normalized to [0,1]
4. **Format conversion**: Converted to consistent format
5. **Stratified splitting**: Balanced distribution across sets

### **File Naming Convention**
```
{original_filename}_processed_{split}_{index}.jpg

Examples:
- healthy_001_20240115_processed_train_0001.jpg
- bacterial_wilt_045_processed_validation_0023.jpg
- leaf_spot_022_processed_test_0012.jpg
```

**Directory Names Match Config**: All subdirectories use exact class names from `config.py`:
- `healthy/`, `bacterial_wilt/`, `rhizome_rot/`, `leaf_spot/`, `soft_rot/`, `yellow_disease/`, `root_knot_nematode/`

## 📊 Dataset Statistics

### **Expected Split Ratios**
- **Training**: 70% of total dataset
- **Validation**: 15% of total dataset  
- **Testing**: 15% of total dataset

### **Class Balance**
Each split maintains proportional representation of all disease classes.

## 🚨 Important Notes

### **Do Not Modify**
- These files are generated by the preprocessing pipeline
- Manual changes will be overwritten on next preprocessing run
- To make changes, modify the raw dataset and rerun preprocessing

### **Regeneration**
To regenerate processed data:
```bash
cd ml-training
python data_preprocessing.py
```

### **Quality Assurance**
- All images are 224x224 pixels
- Consistent file format (JPEG)
- Verified class labels
- No duplicate images across splits

## 📋 Usage

### **For Training**
```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator

train_datagen = ImageDataGenerator(rescale=1./255)
train_generator = train_datagen.flow_from_directory(
    'data/processed/train',
    target_size=(224, 224),
    batch_size=32,
    class_mode='sparse',  # Matches config.py sparse_categorical_crossentropy
    classes=['healthy', 'bacterial_wilt', 'rhizome_rot', 'leaf_spot', 
             'soft_rot', 'yellow_disease', 'root_knot_nematode']
)
```

### **For Validation**
```python
val_datagen = ImageDataGenerator(rescale=1./255)
val_generator = val_datagen.flow_from_directory(
    'data/processed/validation',
    target_size=(224, 224),
    batch_size=32,
    class_mode='sparse',  # Matches config.py sparse_categorical_crossentropy
    classes=['healthy', 'bacterial_wilt', 'rhizome_rot', 'leaf_spot', 
             'soft_rot', 'yellow_disease', 'root_knot_nematode']
)
```

## 🔍 Verification

Before training, verify:
- [ ] All directories contain images
- [ ] Class distribution is balanced
- [ ] No corrupted images
- [ ] Consistent image dimensions
- [ ] Proper file naming

Run verification script:
```bash
python verify_processed_data.py
```
